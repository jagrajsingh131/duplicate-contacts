<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card">
  <h2>Data Duplicater</h2>

  <textarea id="input" rows="6" placeholder="Paste data here"></textarea>
  <textarea id="output" rows="6" placeholder="Duplicated output"></textarea>

  <button id="dup">Duplicate</button>
  <button id="copy">Copy</button>
  <button id="download">Download CSV</button>
  <button id="logout">Logout</button>
</div>

<script type="module">
  import { getUser, logoutLocal, saveDuplicatedData, getDuplicatedData } from "./local.js";

  if (!getUser()) location.href = "index.html";

  output.value = getDuplicatedData();

  document.getElementById("dup").onclick = () => {
    const lines = input.value.split("\n").filter(l => l.trim());
    const result = [];

    lines.forEach(l => {
      result.push(l);
      result.push(l);
    });

    output.value = result.join("\n");
    saveDuplicatedData(output.value);
  };

  document.getElementById("copy").onclick = () => {
    navigator.clipboard.writeText(output.value);
    alert("Copied âœ…");
  };

  document.getElementById("download").onclick = () => {
    const blob = new Blob([output.value], { type: "text/csv" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "duplicated.csv";
    a.click();
  };

  document.getElementById("logout").onclick = () => {
    logoutLocal();
    location.href = "index.html";
  };
</script>

</body>
</html>
